h##############################Pacotes
install.packages("readxl")
install.packages("RMySQL")

library("RMySQL")


#############################Censo
#############Campos Fixos
pes00=c(2,4,5,7,9,11,8,2,2,13,1,1,1,1,1,1,2,2,1,3,2,1,1,3,1,1,1,1,1,1,2,1,1,1,4,2,2,2,1,7,2,7,1,1,2,1,1,2,1,2,2,1,1,1,1,1,1,1,1,1,4,5,1,1,1,1,1,6,6,6,1,6,6,6,6,6,2,2,3,1,1,6,6,6,6,6,6,6,2,2,2,2,2,11,2,2,2,2,2,2,1,2,2,3,3,3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
pes10=c(2,5,13,8,16,1,2,3,2,1,2,2,1,3,3,2,1,1,1,1,1,1,1,1,1,1,4,1,7,7,3,3,1,7,7,7,1,7,7,7,1,1,2,2,1,1,2,1,1,1,3,3,3,1,7,7,7,1,2,1,1,1,1,1,1,1,4,5,1,1,1,1,6,6,6,1,6,9,7,9,7,9,7,10,8,9,3,1,1,1,1,1,1,6,1,7,7,7,1,1,1,2,2,2,1,2,2,2,1,3,1,1,1,2,4,1,2,2,2,2,1,2,1,1,1,1,1,3,1,2,2,2,8,9,4,5,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
dom00=c(2,4,5,7,9,11,8,2,1,2,13,1,1,1,2,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,3,2,2,2,2,2,2,2,2,2,6,6,11,1,1,1)
dom10=c(2,5,13,8,16,1,2,3,2,1,2,2,1,6,9,1,2,3,2,3,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,7,10,8,9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)

###############Nomes
nompes00=c("V0102","V1002","V1003","V0103","V0104","V0105","V0300","V0400","V1004","AREAP","V1001","V1005","V1006","V1007","MARCA","V0401","V0402","V0403","V0404","V4752","V4754","V4070","V0408","V4090","V0410","V0411","V0412","V0413","V0414","V0415","V0416","V0417","V0418","V0419","V0420","V4210","V0422","V4230","V0424","V4250","V4260","V4276","V0428","V0429","V0430","V0431","V0432","V0433","V0434","V4355","V4300","V0436","V0437","V0438","V0439","V0440","V0441","V0442","V0443","V0444","V4452","V4462","V0447","V0448","V0449","V0450","V4511","V4512","V4513","V4514","V4521","V4522","V4523","V4524","V4525","V4526","V0453","V0454","V4534","V0455","V0456","V4573","V4583","V4593","V4603","V4613","V4614","V4615","V4620","V0463","V4654","V4670","V4690","P001","ESTR","ESTRP","V4621","V4622","V4631","V4632","V0464","V4671","V4672","V4354","V4219","V4239","V4269","V4279","V4451","V4461","M0401","M0402","M0403","M0404","M4752","M4754","M0408","M4090","M0410","M0411","M0412","M0413","M0414","M0415","M0416","M0417","M0418","M0419","M0420","M4210","M0422","M4230","M0424","M4250","M4260","M4276","M0428","M0429","M0430","M0431","M0432","M0433","M0434","M4355","M0436","M0437","M0438","M0439","M0440","M0441","M0442","M0443","M0444","M4452","M4462","M0447","M0448","M0449","M0450","M4511","M4512","M4521","M4522","M0453","M0454","M0455","M0456","M4573","M4583","M4593","M4603","M4613","M4620","M4654","M4670","M0463","M4621","M4622","M4631","M4632","M0464","M4671","M4672")
nompes10=c("V0001","V0002","V0011","V0300","V0010","V1001","V1002","V1003","V1004","V1006 ","V0502","V0504","V0601","V6033","V6036","V6037","V6040","V0606","V0613","V0614","V0615","V0616","V0617","V0618","V0619","V0620","V0621","V0622","V6222","V6224","V0623","V0624","V0625","V6252","V6254","V6256","V0626","V6262","V6264","V6266","V0627","V0628","V0629","V0630","V0631","V0632","V0633","V0634","V0635","V6400","V6352","V6354","V6356","V0636","V6362","V6364","V6366","V0637","V0638","V0639","V0640","V0641","V0642","V0643","V0644","V0645","V6461","V6471","V0648","V0649","V0650","V0651","V6511","V6513","V6514","V0652","V6521","V6524","V6525","V6526","V6527","V6528","V6529","V6530","V6531","V6532","V0653","V0654","V0655","V0656","V0657","V0658","V0659","V6591","V0660","V6602","V6604","V6606","V0661","V0662","V0663","V6631","V6632","V6633","V0664","V6641","V6642","V6643","V0665","V6660","V6664","V0667","V0668","V6681","V6682","V0669","V6691","V6692","V6693","V6800","V0670","V0671","V6900","V6910","V6920","V6930","V6940","V6121","V0604","V0605","V5020","V5060","V5070","V5080","V6462","V6472","V5110","V5120","V5030","V5040","V5090","V5100","V5130","M0502","M0601","M6033","M0606","M0613","M0614","M0615","M0616","M0617","M0618","M0619","M0620","M0621","M0622","M6222","M6224","M0623","M0624","M0625","M6252","M6254","M6256","M0626","M6262","M6264","M6266","M0627","M0628","M0629","M0630","M0631","M0632","M0633","M0634","M0635","M6352","M6354","M6356","M0636","M6362","M6364","M6366","M0637","M0638","M0639","M0640","M0641","M0642","M0643","M0644","M0645","M6461","M6471","M0648","M0649","M0650","M0651","M6511","M0652","M6521","M0653","M0654","M0655","M0656","M0657","M0658","M0659","M6591","M0660","M6602","M6604","M6606","M0661","M0662","M0663","M6631","M6632","M6633","M0664","M6641","M6642","M6643","M0665","M6660","M0667","M0668","M6681","M6682","M0669","M6691","M6692","M6693","M0670","M0671","M6800","M6121","M0604","M0605","M6462","M6472","V1005")
nomdom00=c("V0102","V1002","V1003","V0103","V0104","V0105","V0300","V0400","V1001","V1004","AREAP","V1005","V1006","V1007","V0110","V0111","V0201","M0201","V0202","M0202","V0203","M0203","V0204","M0204","V0205","M0205","V0206","M0206","V0207","M0207","V0208","M0208","V0209","M0209","V0210","M0210","V0211","M0211","V0212","M0212","V0213","M0213","V0214","M0214","V0215","M0215","V0216","M0216","V0217","M0217","V0218","M0218","V0219","M0219","V0220","M0220","V0221","M0221","V0222","M0222","V0223","M0223","V7100","V7203","V7204","V7401","V7402","V7403","V7404","V7405","V7406","V7407","V7408","V7409","V7616","V7617","P001","V1111","V1112","V1113")
nomdom10=c("V0001","V0002","V0011","V0300","V0010","V1001","V1002","V1003","V1004","V1006","V4001","V4002","V0201","V2011","V2012","V0202","V0203","V6203","V0204","V6204","V0205","V0206","V0207","V0208","V0209","V0210","V0211","V0212","V0213","V0214","V0215","V0216","V0217","V0218","V0219","V0220","V0221","V0222","V0301","V0401","V0402","V0701","V6529","V6530","V6531","V6532","V6600","V6210","M0201","M2011","M0202","M0203","M0204","M0205","M0206","M0207","M0208","M0209","M0210","M0211","M0212","M0213","M0214","M0215","M0216","M0217","M0218","M0219","M0220","M0221","M0222","M0301","M0401","M0402","M0701","V1005")



######################Importando os Microdados
Pes00=read.fwf('/home/alexandre/Documentos/Artigos/Indice de Pobreza Multidimensional - Ceará/Censo/2000/PES23.txt',widths= pes00,col.names=nompes00)

Pes10=read.fwf('/home/alexandre/Documentos/Artigos/Indice de Pobreza Multidimensional - Ceará/Censo/2010/Amostra_Pessoas_23.txt',widths=pes10,col.names=nompes10)

Dom00=read.fwf('/home/alexandre/Documentos/Artigos/Indice de Pobreza Multidimensional - Ceará/Censo/2000/DOM23.txt',widths=dom00,col.name=nomdom10)

Pes10=read.fwf('/home/alexandre/Documentos/Artigos/Indice de Pobreza Multidimensional - Ceará/Censo/2010//Amostra_Domicilios_23.txt',widths=dom00,col.name=nomdom10)


#######################Exportando os Microdados
write.csv(Pes00,"/home/alexandre/Documentos/Artigos/Indice de Pobreza Multidimensional - Ceará/Censo/Base/Pessoas-2000.csv")

write.csv(Pes10,"/home/alexandre/Documentos/Artigos/Indice de Pobreza Multidimensional - Ceará/Censo/Base/Pessoas-2010.csv")

write.csv(Dom00,"/home/alexandre/Documentos/Artigos/Indice de Pobreza Multidimensional - Ceará/Censo/Base/Domicilio-2000.csv")

write.csv(Dom10,"/home/alexandre/Documentos/Artigos/Indice de Pobreza Multidimensional - Ceará/Censo/Base/Domicilio-2010.csv")

#######################Exportando os Microdados - SQL
con<-dbConnect(MySQL(),user="root",password="pass",dbname="mydb",host="localhost",client.flag=CLIENT_MULTI_STATEMENTS)
########################Criando o Banco de Dados
query1<-"CREATE table PESCE_2000 (ID INT ,V0102 INT(2),V1002 INT(4), V1003 INT(5),V0103 INT(7), V0104 INT(9),V0105 INT(11), V0300 INT(8), V0400 INT(2),V1004 INT(2),AREAP INT(13), V1001 INT(1), V1005 INT(1),V1006 INT(1),V1007 INT(1), MARCA INT(1), V0401 INT(1),V0402 INT(1), V0403 INT(2), V0404 INT(2),V4752 INT(1),V4754 INT(3),V4070 INT(2),V0408 INT(1),V4090 INT(1),V0410 INT(3),V0411 INT(1),V0412 INT(1),V0413 INT(1),V0414 INT(1),V0415 INT(1),V0416 INT(2),V0417 INT(1),V0418 INT(1), V0419 INT(1),V0420 INT(4),V4210 INT(2),V0422 INT(2),V4230 INT(2),V0424 INT(1),V4250 INT(7),V4260 INT(2),V4276 INT(7), V0428 INT(1),V0429 INT(1),V0430 INT(2),V0431 INT(1),V0432 INT(1),V0433 INT(2),V0434 INT(1),V4355 INT(2),V4300 INT(2), V0436 INT(1),V0437 INT(1),V0438 INT(1),V0439 INT(1),V0440 INT(1),V0441 INT(1),V0442 INT(1),V0443 INT(1),V0444 INT(1), V4452 INT(4),V4462 INT(5),V0447 INT(1),V0448 INT(1),V0449 INT(1),V0450 INT(1),V4511 INT(1),V4512 INT(6),V4513 INT(6),V4514 INT(6),V4521 INT(1),V4522 INT(6),V4523 INT(6),V4524 INT(6),V4525 INT(6),V4526 INT(6),V0453 INT(2),V0454 INT(3),V4534 INT(1),V0455 INT(1),V0456 INT(6),V4573 INT(6),V4583 INT(6),V4593 INT(6),V4603 INT(6),V4613 INT(6),V4614 INT(6),V4615 INT(2),V4620 INT(2),V0463 INT(2),V4654 INT(2),V4670 INT(2),V4690 INT(11),P001 INT(2),ESTR INT(2),ESTRP INT(2),V4621 INT(2),V4622 INT(2),V4631 INT(2),V4632 INT(1),V0464 INT(2),V4671 INT(2),V4672 INT(3),V4354 INT(3),V4219 INT(3),V4239 INT(3),V4269 INT(3),V4279 INT(3),V4451 INT(3),V4461 INT(1),M0401 INT(1),M0402 INT(1),M0403 INT(1),M0404 INT(1),M4752 INT(1),M4754 INT(1),M0408 INT(1),M4090 INT(1),M0410 INT(1),M0411 INT(1),M0412 INT(1),M0413 INT(1),M0414 INT(1),M0415 INT(1),M0416 INT(1),M0417 INT(1),M0418 INT(1),M0419 INT(1),M0420 INT(1),M4210 INT(1),M0422 INT(1),M4230 INT(1),M0424 INT(1),M4250 INT(1),M4260 INT(1),M4276 INT(1),M0428 INT(1),M0429 INT(1),M0430 INT(1),M0431 INT(1),M0432 INT(1),M0433 INT(1),M0434 INT(1),M4355 INT(1),M0436 INT(1),M0437 INT(1),M0438 INT(1),M0439 INT(1),M0440 INT(1),M0441 INT(1),M0442 INT(1),M0443 INT(1),M0444 INT(1),M4452 INT(1),M4462 INT(1),M0447 INT(1),M0448 INT(1),M0449 INT(1),M0450 INT(1),M4511 INT(1),M4512 INT(1),M4521 INT(1),M4522 INT(1),M0453 INT(1),M0454 INT(1),M0455 INT(1),M0456 INT(1),M4573 INT(1),M4583 INT(1),M4593 INT(1),M4603 INT(1),M4613 INT(1),M4620 INT(1),M4654 INT(1),M4670 INT(1),M0463 INT(1),M4621 INT(1), M4622  INT(1),M4631 INT(1),M4632 INT(1),M0464 INT(1),M4671 INT(1),M4672 INT(1));"

query2<-"CREATE TABLE DOMCE_2000 (ID INT,V0102 INT(2),V1002 INT(4),V1003 INT(5),V0103 INT(7),V0104 INT(9),V0105 INT(11),V0300 INT(8),V0400 INT(2),V1001 INT(1),V1004 INT(2),AREAP INT(13),V1005 INT(1),V1006 INT(1),V1007 INT(1),V0110 INT(2),V0111 INT(2),V0201 INT(1),M0201 INT(1),V0202 INT(1),M0202 INT(1),V0203 INT(2),M0203 INT(1),V0204 INT(1),M0204 INT(1),V0205 INT(1),M0205 INT(1),V0206 INT(1),M0206 INT(1),V0207 INT(1),M0207 INT(1),V0208 INT(1),M0208 INT(1),V0209 INT(1),M0209 INT(1),V0210 INT(1),M0210 INT(1),V0211 INT(1),M0211 INT(1),V0212 INT(1),M0212 INT(1),V0213 INT(1),M0213 INT(1),V0214 INT(1),M0214 INT(1),V0215 INT(1),M0215 INT(1),V0216 INT(1),M0216 INT(1),V0217 INT(1),M0217 INT(1),V0218 INT(1),M0218 INT(1),V0219 INT(1),M0219 INT(1),V0220 INT(1),M0220 INT(1),V0221 INT(1),M0221 INT(1),V0222 INT(1),M0222 INT(1),V0223 INT(1),M0223 INT(1),V7100 INT(2),V7203 INT(3),V7204 INT(3),V7401 INT(2),V7402 INT(2),V7403 INT(2),V7404 INT(2),V7405 INT(2),V7406 INT(2),V7407 INT(2),V7408 INT(2),V7409 INT(2),V7616 INT(6),V7617 INT(6),P001 INT(11),V1111 INT(1),V1112 INT(1),V1113 INT (1));"

query3<-"CREATE TABLE PESCE_2010 (ID INT,V0001  INT,V0002  INT,V0011  INT,V0300  INT,V0010  INT,V1001  INT,V1002  INT,V1003  INT,V1004  INT,V1006   INT,V0502  INT,V0504  INT,V0601  INT,V6033  INT,V6036  INT,V6037  INT,V6040  INT,V0606  INT,V0613  INT,V0614  INT,V0615  INT,V0616  INT,V0617  INT,V0618  INT,V0619  INT,V0620  INT,V0621  INT,V0622  INT,V6222  INT,V6224  INT,V0623  INT,V0624  INT,V0625  INT,V6252  INT,V6254  INT,V6256  INT,V0626  INT,V6262  INT,V6264  INT,V6266  INT,V0627  INT,V0628  INT,V0629  INT,V0630  INT,V0631  INT,V0632  INT,V0633  INT,V0634  INT,V0635  INT,V6400  INT,V6352  INT,V6354  INT,V6356  INT,V0636  INT,V6362  INT,V6364  INT,V6366  INT,V0637  INT,V0638  INT,V0639  INT,V0640  INT,V0641  INT,V0642  INT,V0643  INT,V0644  INT,V0645  INT,V6461  INT,V6471  INT,V0648  INT,V0649  INT,V0650  INT,V0651  INT,V6511  INT,V6513  INT,V6514  INT,V0652  INT,V6521  INT,V6524  INT,V6525  INT,V6526  INT,V6527  INT,V6528  INT,V6529  INT,V6530  INT,V6531  INT,V6532  INT,V0653  INT,V0654  INT,V0655  INT,V0656  INT,V0657  INT,V0658  INT,V0659  INT,V6591  INT,V0660  INT,V6602  INT,V6604  INT,V6606  INT,V0661  INT,V0662  INT,V0663  INT,V6631  INT,V6632  INT,V6633  INT,V0664  INT,V6641  INT,V6642  INT,V6643  INT,V0665  INT,V6660  INT,V6664  INT,V0667  INT,V0668  INT,V6681  INT,V6682  INT,V0669  INT,V6691  INT,V6692  INT,V6693  INT,V6800  INT,V0670  INT,V0671  INT,V6900  INT,V6910  INT,V6920  INT,V6930  INT,V6940  INT,V6121  INT,V0604  INT,V0605  INT,V5020  INT,V5060  INT,V5070  INT,V5080  INT,V6462  INT,V6472  INT,V5110  INT,V5120  INT,V5030  INT,V5040  INT,V5090  INT,V5100  INT,V5130  INT,M0502  INT,M0601  INT,M6033  INT,M0606  INT,M0613  INT,M0614  INT,M0615  INT,M0616  INT,M0617  INT,M0618  INT,M0619  INT,M0620  INT,M0621  INT,M0622  INT,M6222  INT,M6224  INT,M0623  INT,M0624  INT,M0625  INT,M6252  INT,M6254  INT,M6256  INT,M0626  INT,M6262  INT,M6264  INT,M6266  INT,M0627  INT,M0628  INT,M0629  INT,M0630  INT,M0631  INT,M0632  INT,M0633  INT,M0634  INT,M0635  INT,M6352  INT,M6354  INT,M6356  INT,M0636  INT,M6362  INT,M6364  INT,M6366  INT,M0637  INT,M0638  INT,M0639  INT,M0640  INT,M0641  INT,M0642  INT,M0643  INT,M0644  INT,M0645  INT,M6461  INT,M6471  INT,M0648  INT,M0649  INT,M0650  INT,M0651  INT,M6511  INT,M0652  INT,M6521  INT,M0653  INT,M0654  INT,M0655  INT,M0656  INT,M0657  INT,M0658  INT,M0659  INT,M6591  INT,M0660  INT,M6602  INT,M6604  INT,M6606  INT,M0661  INT,M0662  INT,M0663  INT,M6631  INT,M6632  INT,M6633  INT,M0664  INT,M6641  INT,M6642  INT,M6643  INT,M0665  INT,M6660  INT,M0667  INT,M0668  INT,M6681  INT,M6682  INT,M0669  INT,M6691  INT,M6692  INT,M6693  INT,M0670  INT,M0671  INT,M6800  INT,M6121  INT,M0604  INT,M0605  INT,M6462  INT,M6472  INT,V1005 INT);"

query4<-'CREATE TABLE DOMCE_2010 (ID INT,V0001 INT,V0002 INT,V0011 INT,V0300 INT,V0010 INT,V1001 INT,V1002 INT,V1003 INT,V1004 INT,V1006 INT,V4001 INT,V4002 INT,V0201 INT,V2011 INT,V2012 INT,V0202 INT,V0203 INT,V6203 INT,V0204 INT,V6204 INT,V0205 INT,V0206 INT,V0207 INT,V0208 INT,V0209 INT,V0210 INT,V0211 INT,V0212 INT,V0213 INT,V0214 INT,V0215 INT,V0216 INT,V0217 INT,V0218 INT,V0219 INT,V0220 INT,V0221 INT,V0222 INT,V0301 INT,V0401 INT,V0402 INT,V0701 INT,V6529 INT,V6530 INT,V6531 INT,V6532 INT,V6600 INT,V6210 INT,M0201 INT,M2011 INT,M0202 INT,M0203 INT,M0204 INT,M0205 INT,M0206 INT,M0207 INT,M0208 INT,M0209 INT,M0210 INT,M0211 INT,M0212 INT,M0213 INT,M0214 INT,M0215 INT,M0216 INT,M0217 INT,M0218 INT,M0219 INT,M0220 INT,M0221 INT,M0222 INT,M0301 INT,M0401 INT,M0402 INT,M0701 INT,V1005 INT);'

dbClearResult(dbSendQuery(con,query1))
dbClearResult(dbSendQuery(con,query2))
dbClearResult(dbSendQuery(con,query3))
dbClearResult(dbSendQuery(con,query4))

                            
dbListTables(con)

#yourtable <- dbReadTable(con,"PESCE_2000")
# write it back
dbWriteTable(con,"PESCE_2000",Pes00,overwrite=T)
dbWriteTable(con,"PESCE_2010",Pes10,overwrite=T)
dbWriteTable(con,"DOMCE_2000",Dom00,overwrite=T)
dbWriteTable(con,"DOMCE_2010",Dom10,overwrite=T)
# watch out with the overwrite argument it does what it says :)
#dbDisconnect(con)








